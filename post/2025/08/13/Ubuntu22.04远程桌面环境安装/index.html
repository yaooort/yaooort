<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.49">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" type="image/png" sizes="16x16" href="/img/logo/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/logo/favicon-32x32.png"><meta name="application-name" content="yao oort"><meta name="apple-mobile-web-app-title" content="0ort"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/img/logo/apple-touch-icon.png"><meta name="theme-color" content="#377bb5"><meta name="msapplication-TileColor" content="#377bb5"><script data-ad-client="ca-pub-8875743245757885" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><title>Ubuntu 22.04 远程桌面环境安装 | Oort</title><meta name="description" content="笔墨间，岁月静好，吾心所向，字字珠玑，篇篇不朽。">
    <link rel="modulepreload" href="/assets/app.414af06b.js"><link rel="modulepreload" href="/assets/index.html.d86f3688.js"><link rel="modulepreload" href="/assets/index.html.c61a7887.js"><link rel="prefetch" href="/assets/index.html.134bc726.js"><link rel="prefetch" href="/assets/index.html.71d73135.js"><link rel="prefetch" href="/assets/index.html.e3cccb1f.js"><link rel="prefetch" href="/assets/index.html.32b63e0d.js"><link rel="prefetch" href="/assets/index.html.959a6e10.js"><link rel="prefetch" href="/assets/index.html.37832aee.js"><link rel="prefetch" href="/assets/index.html.e71d5a74.js"><link rel="prefetch" href="/assets/index.html.25a9bb20.js"><link rel="prefetch" href="/assets/index.html.6d006903.js"><link rel="prefetch" href="/assets/index.html.9bfedec3.js"><link rel="prefetch" href="/assets/index.html.d7f4dd29.js"><link rel="prefetch" href="/assets/index.html.1131db38.js"><link rel="prefetch" href="/assets/index.html.7e4c9d8a.js"><link rel="prefetch" href="/assets/404.html.4256f744.js"><link rel="prefetch" href="/assets/index.html.2dff2632.js"><link rel="prefetch" href="/assets/index.html.7e0a25d2.js"><link rel="prefetch" href="/assets/index.html.2aca75dc.js"><link rel="prefetch" href="/assets/index.html.84251657.js"><link rel="prefetch" href="/assets/index.html.76b45583.js"><link rel="prefetch" href="/assets/index.html.4fae652c.js"><link rel="prefetch" href="/assets/index.html.df37cd61.js"><link rel="prefetch" href="/assets/index.html.04c9a6ff.js"><link rel="prefetch" href="/assets/index.html.af06aaee.js"><link rel="prefetch" href="/assets/index.html.14ee9f25.js"><link rel="prefetch" href="/assets/index.html.f65f5d25.js"><link rel="prefetch" href="/assets/index.html.c0ec3954.js"><link rel="prefetch" href="/assets/index.html.360bed3d.js"><link rel="prefetch" href="/assets/index.html.57b3033c.js"><link rel="prefetch" href="/assets/index.html.17754cde.js"><link rel="prefetch" href="/assets/index.html.c8b75fcc.js"><link rel="prefetch" href="/assets/index.html.fda8ca05.js"><link rel="prefetch" href="/assets/index.html.4cabcd23.js"><link rel="prefetch" href="/assets/index.html.ec023393.js"><link rel="prefetch" href="/assets/index.html.a09974e8.js"><link rel="prefetch" href="/assets/index.html.f6d055ce.js"><link rel="prefetch" href="/assets/index.html.f2890982.js"><link rel="prefetch" href="/assets/index.html.80f17465.js"><link rel="prefetch" href="/assets/index.html.dce1e616.js"><link rel="prefetch" href="/assets/index.html.f24d0be8.js"><link rel="prefetch" href="/assets/404.html.8e81cfd8.js"><link rel="prefetch" href="/assets/index.html.27a133c9.js"><link rel="prefetch" href="/assets/index.html.07aedf82.js"><link rel="prefetch" href="/assets/index.html.ce4165bb.js"><link rel="prefetch" href="/assets/index.html.24d7ef07.js"><link rel="prefetch" href="/assets/index.html.09609dbb.js"><link rel="prefetch" href="/assets/index.html.2ce4085c.js"><link rel="prefetch" href="/assets/index.html.5534ece2.js"><link rel="prefetch" href="/assets/index.html.cd5b7fca.js"><link rel="prefetch" href="/assets/index.html.f28f3734.js"><link rel="prefetch" href="/assets/index.html.23e3a438.js"><link rel="prefetch" href="/assets/index.html.c38941a3.js"><link rel="prefetch" href="/assets/index.html.f7c27d99.js"><link rel="prefetch" href="/assets/404.ddd1017b.js"><link rel="prefetch" href="/assets/HomePage.421c3e56.js"><link rel="prefetch" href="/assets/Layout.0560498f.js"><link rel="prefetch" href="/assets/Links.883b6053.js"><link rel="prefetch" href="/assets/Post.46a420b4.js"><link rel="prefetch" href="/assets/Tags.68cb77bc.js"><link rel="prefetch" href="/assets/mermaid.core.e7a6d12e.js">
    <link rel="stylesheet" href="/assets/style.3014ee23.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container no-sidebar"><!--[--><header class="navbar invert"><span><a href="/" class=""><span class="site-name">0.0</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg></span><span>首页</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/tags/" class="" aria-label="标签"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg></span><span>标签</span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://oortk.com/web/" rel="noopener noreferrer" target="_blank" aria-label="开发者工具"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M305.45 462.59c7.391 7.298 6.188 20.097-3 25.004-77.714 41.802-176.726 29.91-242.344-35.709-65.602-65.603-77.51-164.523-35.692-242.331 4.891-9.095 17.69-10.298 25.003-3l116.812 116.813 27.394-27.394c-.688-2.61-1.594-5.001-1.594-7.814a32.004 32.004 0 1132.004 32.005c-2.797 0-5.204-.891-7.798-1.594l-27.41 27.41zm206.526-159.523a16.103 16.103 0 01-16.002 17.003H463.86a15.97 15.97 0 01-15.892-15.002C440.467 175.549 336.453 70.534 207.03 63.533a15.845 15.845 0 01-15.002-15.908V16.027A16.094 16.094 0 01209.03.024C372.255 8.62 503.475 139.841 511.976 303.067zm-96.012-.297a16.21 16.21 0 01-16.112 17.3h-32.207a16.069 16.069 0 01-15.893-14.705c-6.907-77.011-68.118-138.91-144.924-145.224a15.94 15.94 0 01-14.8-15.893v-32.114a16.134 16.134 0 0117.3-16.096c110.123 8.501 198.228 96.607 206.636 206.732z"/></svg></span><span>开发者工具</span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://oortk.com" rel="noopener noreferrer" target="_blank" aria-label="关于"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg></span><span>关于</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>搜索</span></a></div></nav><!--[--><!--]--><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="首页"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M489.2 287.9h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6V146.2c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32h-36.6v-32c0-6-8-4.6-11.7-4.6v-38c8.3-2 17.1-3.4 25.7-3.4 10.9 0 20.9 4.3 31.4 4.3 4.6 0 27.7-1.1 27.7-8v-60c0-2.6-2-4.6-4.6-4.6-5.1 0-15.1 4.3-24 4.3-9.7 0-20.9-4.3-32.6-4.3-8 0-16 1.1-23.7 2.9v-4.9c5.4-2.6 9.1-8.3 9.1-14.3 0-20.7-31.4-20.8-31.4 0 0 6 3.7 11.7 9.1 14.3v111.7c-3.7 0-11.7-1.4-11.7 4.6v32h-36.6v-32c0-2.6-2-4.6-4.6-4.6h-27.4c-2.6 0-4.6 2-4.6 4.6v32H128v-32c0-2.6-2-4.6-4.6-4.6H96c-2.6 0-4.6 2-4.6 4.6v178.3H54.8v-32c0-2.6-2-4.6-4.6-4.6H22.8c-2.6 0-4.6 2-4.6 4.6V512h182.9v-96c0-72.6 109.7-72.6 109.7 0v96h182.9V292.5c.1-2.6-1.9-4.6-4.5-4.6zm-288.1-4.5c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64zm146.4 0c0 2.6-2 4.6-4.6 4.6h-27.4c-2.6 0-4.6-2-4.6-4.6v-64c0-2.6 2-4.6 4.6-4.6h27.4c2.6 0 4.6 2 4.6 4.6v64z"/></svg></span><span>首页</span><!--[--><!--]--></a></div><div class="navbar-item"><a href="/tags/" class="" aria-label="标签"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg></span><span>标签</span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://oortk.com/web/" rel="noopener noreferrer" target="_blank" aria-label="开发者工具"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M305.45 462.59c7.391 7.298 6.188 20.097-3 25.004-77.714 41.802-176.726 29.91-242.344-35.709-65.602-65.603-77.51-164.523-35.692-242.331 4.891-9.095 17.69-10.298 25.003-3l116.812 116.813 27.394-27.394c-.688-2.61-1.594-5.001-1.594-7.814a32.004 32.004 0 1132.004 32.005c-2.797 0-5.204-.891-7.798-1.594l-27.41 27.41zm206.526-159.523a16.103 16.103 0 01-16.002 17.003H463.86a15.97 15.97 0 01-15.892-15.002C440.467 175.549 336.453 70.534 207.03 63.533a15.845 15.845 0 01-15.002-15.908V16.027A16.094 16.094 0 01209.03.024C372.255 8.62 503.475 139.841 511.976 303.067zm-96.012-.297a16.21 16.21 0 01-16.112 17.3h-32.207a16.069 16.069 0 01-15.893-14.705c-6.907-77.011-68.118-138.91-144.924-145.224a15.94 15.94 0 01-14.8-15.893v-32.114a16.134 16.134 0 0117.3-16.096c110.123 8.501 198.228 96.607 206.636 206.732z"/></svg></span><span>开发者工具</span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://oortk.com" rel="noopener noreferrer" target="_blank" aria-label="关于"><!--[--><!--]--><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 224c-79.41 0-192 122.76-192 200.25 0 34.9 26.81 55.75 71.74 55.75 48.84 0 81.09-25.08 120.26-25.08 39.51 0 71.85 25.08 120.26 25.08 44.93 0 71.74-20.85 71.74-55.75C448 346.76 335.41 224 256 224zm-147.28-12.61c-10.4-34.65-42.44-57.09-71.56-50.13-29.12 6.96-44.29 40.69-33.89 75.34 10.4 34.65 42.44 57.09 71.56 50.13 29.12-6.96 44.29-40.69 33.89-75.34zm84.72-20.78c30.94-8.14 46.42-49.94 34.58-93.36s-46.52-72.01-77.46-63.87-46.42 49.94-34.58 93.36c11.84 43.42 46.53 72.02 77.46 63.87zm281.39-29.34c-29.12-6.96-61.15 15.48-71.56 50.13-10.4 34.65 4.77 68.38 33.89 75.34 29.12 6.96 61.15-15.48 71.56-50.13 10.4-34.65-4.77-68.38-33.89-75.34zm-156.27 29.34c30.94 8.14 65.62-20.45 77.46-63.87 11.84-43.42-3.64-85.21-34.58-93.36s-65.62 20.45-77.46 63.87c-11.84 43.42 3.64 85.22 34.58 93.36z"/></svg></span><span>关于</span><!--[--><!--]--></a></div><!--]--><div class="navbar-item"><a style="cursor:pointer;"><span class="nav-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 2c4.968 0 9 4.032 9 9s-4.032 9-9 9-9-4.032-9-9 4.032-9 9-9zm0 16c3.867 0 7-3.133 7-7 0-3.868-3.133-7-7-7-3.868 0-7 3.132-7 7 0 3.867 3.132 7 7 7zm8.485.071l2.829 2.828-1.415 1.415-2.828-2.829 1.414-1.414z"/></svg></span><span>搜索</span></a></div></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><!--]--><div class="page-content"><!--[--><div class="show-catalog post-wrapper"><div class="article-header use-image post-header" style="background-image:url(/img/in-post/2025-08-13/header.jpg);"><div class="article-header-mask" style="background:rgb(14, 21, 5, .2);"></div><div class="article-header-content"><div class="article-tags"><!--[--><a href="/tags/%E8%BF%90%E7%BB%B4/" class="article-tag">运维</a><!--]--></div><h1 class="article-title">Ubuntu 22.04 远程桌面环境安装</h1><p class="article-subtitle">Ubuntu 22.04 远程桌面环境安装</p><div class="article-icons"><div class="article-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M313.6 304c-28.7 0-42.5 16-89.6 16-47.1 0-60.8-16-89.6-16C60.2 304 0 364.2 0 438.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-25.6c0-74.2-60.2-134.4-134.4-134.4zM400 464H48v-25.6c0-47.6 38.8-86.4 86.4-86.4 14.6 0 38.3 16 89.6 16 51.7 0 74.9-16 89.6-16 47.6 0 86.4 38.8 86.4 86.4V464zM224 288c79.5 0 144-64.5 144-144S303.5 0 224 0 80 64.5 80 144s64.5 144 144 144zm0-240c52.9 0 96 43.1 96 96s-43.1 96-96 96-96-43.1-96-96 43.1-96 96-96z"/></svg><span>Oort</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M400 64h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54c-3.3 0-6-2.7-6-6V160h352v298c0 3.3-2.7 6-6 6z"/></svg><span>2025-08-13</span></div><div class="article-icon"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="0 0 24 24" fill="currentColor"><path fill="none" d="M0 0h24v24H0z"/><path d="M17.618 5.968l1.453-1.453 1.414 1.414-1.453 1.453a9 9 0 11-1.414-1.414zM12 20a7 7 0 100-14 7 7 0 000 14zM11 8h2v6h-2V8zM8 1h8v2H8V1z"/></svg><span>19 min</span></div></div></div><!----></div><main class="page post-content"><!--[--><!--]--><div class="theme-gungnir-content"><!--[--><!--]--><div><h1 id="ubuntu-22-04-远程桌面环境安装与最佳实践全指南" tabindex="-1"><a class="header-anchor" href="#ubuntu-22-04-远程桌面环境安装与最佳实践全指南" aria-hidden="true">#</a> Ubuntu 22.04 远程桌面环境安装与最佳实践全指南</h1><blockquote><p>适用版本：Ubuntu 22.04 LTS（其他 22.x 基本同理）<br> 适用场景：云服务器图形化管理、图形开发、教学演示、远程办公、低带宽远控</p></blockquote><hr><h3 id="直接上完整的一键安装-shell" tabindex="-1"><a class="header-anchor" href="#直接上完整的一键安装-shell" aria-hidden="true">#</a> 直接上完整的一键安装 shell</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token shebang important">#!/usr/bin/env bash</span>
<span class="token comment"># 支持 root 会话的修复版 GNOME + xrdp + TigerVNC 安装脚本</span>
<span class="token comment"># 模式: full|minimal|core  (core 不依赖 snapd/firefox)</span>
<span class="token comment"># 新增: ALLOW_ROOT=1 允许使用 root 作为 TARGET_USER</span>
<span class="token comment">#</span>
<span class="token comment"># 环境变量:</span>
<span class="token comment">#   DESKTOP_MODE=full|minimal|core (默认 full)</span>
<span class="token comment">#   SNAP_POLICY=install|switch-core|fail (默认 install)</span>
<span class="token comment">#   TARGET_USER=&lt;用户名&gt; (默认自动推断；若最终为 root 需 ALLOW_ROOT=1)</span>
<span class="token comment">#   ALLOW_ROOT=1 允许 root 作为图形用户</span>
<span class="token comment">#   VNC_PASS=xxx</span>
<span class="token comment">#   VNC_GEOMETRY=1920x1080</span>
<span class="token comment">#   VNC_DEPTH=24</span>
<span class="token comment">#   AUTO_DISABLE_ANIMATION=1|0 (root 下会自动跳过)</span>
<span class="token comment">#   HEALTH_CHECK=1|0</span>
<span class="token comment">#</span>
<span class="token comment"># 参数:</span>
<span class="token comment">#   --verify 同 HEALTH_CHECK=1</span>
<span class="token comment">#   --no-firefox 提示绕过 firefox (需改 core)</span>
<span class="token comment">#</span>
<span class="token builtin class-name">set</span> <span class="token parameter variable">-euo</span> pipefail

<span class="token assign-left variable">NO_FIREFOX</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token assign-left variable">RUN_VERIFY</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${HEALTH_CHECK<span class="token operator">:-</span>0}</span>&quot;</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">a</span> <span class="token keyword">in</span> <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$a</span>&quot;</span> <span class="token keyword">in</span>
    --verify<span class="token punctuation">)</span> <span class="token assign-left variable">RUN_VERIFY</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
    --no-firefox<span class="token punctuation">)</span> <span class="token assign-left variable">NO_FIREFOX</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token keyword">esac</span>
<span class="token keyword">done</span>

<span class="token function-name function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token builtin class-name">printf</span> <span class="token string">&quot;%s %s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$2</span>&quot;</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token function-name function">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> log <span class="token string">&quot;ERROR&quot;</span> <span class="token string">&quot;<span class="token variable">$1</span>&quot;</span><span class="token punctuation">;</span> <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token environment constant">$EUID</span> <span class="token parameter variable">-ne</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> die <span class="token string">&quot;请用 root 或 sudo 运行&quot;</span><span class="token punctuation">;</span> <span class="token keyword">fi</span>
<span class="token builtin class-name">command</span> <span class="token parameter variable">-v</span> <span class="token function">apt-get</span> <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">||</span> die <span class="token string">&quot;仅支持 apt 的 Ubuntu&quot;</span>

<span class="token assign-left variable">DESKTOP_MODE</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${DESKTOP_MODE<span class="token operator">:-</span>full}</span>&quot;</span>
<span class="token assign-left variable">SNAP_POLICY</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${SNAP_POLICY<span class="token operator">:-</span>install}</span>&quot;</span>
<span class="token assign-left variable">VNC_PASS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${VNC_PASS<span class="token operator">:-</span>aa123123}</span>&quot;</span>
<span class="token assign-left variable">VNC_GEOMETRY</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${VNC_GEOMETRY<span class="token operator">:-</span>1920x1080}</span>&quot;</span>
<span class="token assign-left variable">VNC_DEPTH</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${VNC_DEPTH<span class="token operator">:-</span>24}</span>&quot;</span>
<span class="token assign-left variable">AUTO_DISABLE_ANIMATION</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${AUTO_DISABLE_ANIMATION<span class="token operator">:-</span>1}</span>&quot;</span>
<span class="token assign-left variable">ALLOW_ROOT</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${ALLOW_ROOT<span class="token operator">:-</span>1}</span>&quot;</span>

<span class="token comment"># ---------- 用户解析 (支持 root) ----------</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">${TARGET_USER<span class="token operator">:-</span>}</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">id</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
    die <span class="token string">&quot;指定的 TARGET_USER=<span class="token variable">$TARGET_USER</span> 不存在&quot;</span>
  <span class="token keyword">fi</span>
<span class="token keyword">else</span>
  <span class="token assign-left variable">CAND</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${SUDO_USER<span class="token operator">:-</span>$(logname 2&gt;<span class="token operator">/</span>dev<span class="token operator">/</span>null || true)}</span>&quot;</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$CAND</span>&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$CAND</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;root&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">id</span> <span class="token string">&quot;<span class="token variable">$CAND</span>&quot;</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">TARGET_USER</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$CAND</span>&quot;</span>
  <span class="token keyword">else</span>
    <span class="token assign-left variable">TARGET_USER</span><span class="token operator">=</span><span class="token string">&quot;root&quot;</span>
  <span class="token keyword">fi</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;root&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$ALLOW_ROOT</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;1&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  die <span class="token string">&quot;将使用 root 作为桌面用户。请显式 ALLOW_ROOT=1 以确认: sudo ALLOW_ROOT=1 TARGET_USER=root <span class="token variable">$0</span>&quot;</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">HOME_DIR</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">eval</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;~<span class="token variable">$TARGET_USER</span>&quot;</span><span class="token variable">)</span></span>&quot;</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;<span class="token variable">$HOME_DIR</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">||</span> die <span class="token string">&quot;用户家目录不存在: <span class="token variable">$HOME_DIR</span>&quot;</span>

<span class="token builtin class-name">export</span> <span class="token assign-left variable">DEBIAN_FRONTEND</span><span class="token operator">=</span>noninteractive

log INFO <span class="token string">&quot;================ 配置概要 ================&quot;</span>
log INFO <span class="token string">&quot;目标用户:            <span class="token variable">$TARGET_USER</span>&quot;</span>
log INFO <span class="token string">&quot;HOME:                <span class="token variable">$HOME_DIR</span>&quot;</span>
log INFO <span class="token string">&quot;桌面模式:            <span class="token variable">$DESKTOP_MODE</span>&quot;</span>
log INFO <span class="token string">&quot;SNAP 策略:           <span class="token variable">$SNAP_POLICY</span>&quot;</span>
log INFO <span class="token string">&quot;允许 root:           <span class="token variable">$ALLOW_ROOT</span>&quot;</span>
log INFO <span class="token string">&quot;RDP 端口:            3389&quot;</span>
log INFO <span class="token string">&quot;VNC 端口(:1):        5901&quot;</span>
log INFO <span class="token string">&quot;VNC 分辨率/深度:     <span class="token variable">$VNC_GEOMETRY</span> / <span class="token variable">$VNC_DEPTH</span>&quot;</span>
log INFO <span class="token string">&quot;关闭动画:            <span class="token variable">$AUTO_DISABLE_ANIMATION</span> (root 会跳过)&quot;</span>
log INFO <span class="token string">&quot;健康检查:            <span class="token variable">$RUN_VERIFY</span>&quot;</span>
log INFO <span class="token string">&quot;no-firefox 标志:     <span class="token variable">$NO_FIREFOX</span>&quot;</span>
log INFO <span class="token string">&quot;===========================================&quot;</span>
<span class="token function">sleep</span> <span class="token number">1</span>

<span class="token comment"># ---------- snapd 需求判定 ----------</span>
<span class="token assign-left variable">need_snap</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$DESKTOP_MODE</span>&quot;</span> <span class="token keyword">in</span>
  full<span class="token operator">|</span>minimal<span class="token punctuation">)</span> <span class="token assign-left variable">need_snap</span><span class="token operator">=</span><span class="token number">1</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
  core<span class="token punctuation">)</span> <span class="token assign-left variable">need_snap</span><span class="token operator">=</span><span class="token number">0</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
  *<span class="token punctuation">)</span> die <span class="token string">&quot;DESKTOP_MODE 无效: <span class="token variable">$DESKTOP_MODE</span>&quot;</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>

<span class="token assign-left variable">snap_available</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token keyword">if</span> <span class="token operator">!</span> dpkg <span class="token parameter variable">-s</span> snapd <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token assign-left variable">snap_available</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">elif</span> <span class="token operator">!</span> systemctl is-active snapd.socket <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span> systemctl is-active snapd <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token assign-left variable">snap_available</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">snap_pinned_neg</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">if</span> <span class="token function">grep</span> <span class="token parameter variable">-Riq</span> <span class="token string">&quot;Package: *snapd&quot;</span> /etc/apt/preferences /etc/apt/preferences.d <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token keyword">if</span> <span class="token function">grep</span> <span class="token parameter variable">-R</span> <span class="token string">&quot;Package: *snapd&quot;</span> <span class="token parameter variable">-n</span> /etc/apt/preferences /etc/apt/preferences.d <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token punctuation">\</span>
     <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> f<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token function">grep</span> <span class="token parameter variable">-A2</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;Package: *snapd&quot;</span> <span class="token string">&quot;<span class="token variable">${f<span class="token operator">%%</span><span class="token operator">:</span>*}</span>&quot;</span><span class="token punctuation">;</span> <span class="token keyword">done</span> <span class="token punctuation">\</span>
     <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-qi</span> <span class="token string">&quot;Pin-Priority: *-\?1&quot;</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token assign-left variable">snap_pinned_neg</span><span class="token operator">=</span><span class="token number">1</span>
  <span class="token keyword">fi</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$need_snap</span> <span class="token parameter variable">-eq</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$snap_available</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$SNAP_POLICY</span>&quot;</span> <span class="token keyword">in</span>
    <span class="token function">install</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$snap_pinned_neg</span> <span class="token parameter variable">-eq</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        log WARN <span class="token string">&quot;snapd 有负优先级 pin，改用 core 模式&quot;</span>
        <span class="token assign-left variable">DESKTOP_MODE</span><span class="token operator">=</span><span class="token string">&quot;core&quot;</span><span class="token punctuation">;</span> <span class="token assign-left variable">need_snap</span><span class="token operator">=</span><span class="token number">0</span>
      <span class="token keyword">else</span>
        log ACTION <span class="token string">&quot;安装 snapd...&quot;</span>
        <span class="token function">apt-get</span> update <span class="token parameter variable">-y</span>
        <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> snapd
        systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> snapd.socket <span class="token operator">||</span> <span class="token boolean">true</span>
        <span class="token assign-left variable">snap_available</span><span class="token operator">=</span><span class="token number">1</span>
      <span class="token keyword">fi</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
    switch-core<span class="token punctuation">)</span>
      log ACTION <span class="token string">&quot;SNAP_POLICY=switch-core -&gt; 切换 core&quot;</span>
      <span class="token assign-left variable">DESKTOP_MODE</span><span class="token operator">=</span><span class="token string">&quot;core&quot;</span><span class="token punctuation">;</span> <span class="token assign-left variable">need_snap</span><span class="token operator">=</span><span class="token number">0</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
    fail<span class="token punctuation">)</span>
      die <span class="token string">&quot;需要 snapd 但不可用。改 DESKTOP_MODE=core 或设置 SNAP_POLICY=install&quot;</span>
      <span class="token punctuation">;</span><span class="token punctuation">;</span>
    *<span class="token punctuation">)</span> die <span class="token string">&quot;SNAP_POLICY 无效: <span class="token variable">$SNAP_POLICY</span>&quot;</span> <span class="token punctuation">;</span><span class="token punctuation">;</span>
  <span class="token keyword">esac</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$NO_FIREFOX</span> <span class="token parameter variable">-eq</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$DESKTOP_MODE</span> <span class="token operator">!=</span> <span class="token string">&quot;core&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  log WARN <span class="token string">&quot;--no-firefox 仅提示。完整/最小桌面元包仍会拉 firefox；避免请用 core。&quot;</span>
<span class="token keyword">fi</span>

<span class="token comment"># ---------- 安装 ----------</span>
log INFO <span class="token string">&quot;[1/9] apt 更新&quot;</span>
<span class="token function">apt-get</span> update <span class="token parameter variable">-y</span>
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> software-properties-common <span class="token function">curl</span> <span class="token function">wget</span> locales gsettings-desktop-schemas dbus-x11

log INFO <span class="token string">&quot;[2/9] 安装桌面 (<span class="token variable">$DESKTOP_MODE</span>)&quot;</span>
<span class="token function-name function">install_core</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> --no-install-recommends <span class="token punctuation">\</span>
    gnome-shell gnome-session gdm3 gnome-terminal nautilus <span class="token punctuation">\</span>
    adwaita-icon-theme mesa-utils x11-xserver-utils policykit-1 fonts-dejavu-core
<span class="token punctuation">}</span>
<span class="token keyword">case</span> <span class="token string">&quot;<span class="token variable">$DESKTOP_MODE</span>&quot;</span> <span class="token keyword">in</span>
  full<span class="token punctuation">)</span>    <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> ubuntu-desktop <span class="token punctuation">;</span><span class="token punctuation">;</span>
  minimal<span class="token punctuation">)</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> ubuntu-desktop-minimal <span class="token punctuation">;</span><span class="token punctuation">;</span>
  core<span class="token punctuation">)</span>    install_core <span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>

log INFO <span class="token string">&quot;[3/9] 禁用 Wayland&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> /etc/gdm3/custom.conf <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^#\?WaylandEnable=.*/WaylandEnable=false/&#39;</span> /etc/gdm3/custom.conf
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">&quot;[daemon]<span class="token entity" title="\n">\n</span>WaylandEnable=false&quot;</span> <span class="token operator">&gt;</span>/etc/gdm3/custom.conf
<span class="token keyword">fi</span>
systemctl restart gdm3 <span class="token operator">||</span> <span class="token boolean">true</span>

log INFO <span class="token string">&quot;[4/9] 安装 xrdp&quot;</span>
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> xrdp
adduser <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> ssl-cert <span class="token operator">||</span> <span class="token boolean">true</span>

<span class="token comment"># 允许 root 登录 (sesman.ini)</span>
<span class="token keyword">if</span> <span class="token function">grep</span> <span class="token parameter variable">-q</span> <span class="token string">&#39;^AllowRootLogin=&#39;</span> /etc/xrdp/sesman.ini<span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;s/^AllowRootLogin=.*/AllowRootLogin=1/&#39;</span> /etc/xrdp/sesman.ini
<span class="token keyword">else</span>
  <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/^\[Security\]/a AllowRootLogin=1&#39;</span> /etc/xrdp/sesman.ini
<span class="token keyword">fi</span>

<span class="token assign-left variable">XRDP_STARTWM</span><span class="token operator">=</span><span class="token string">&quot;/etc/xrdp/startwm.sh&quot;</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">grep</span> <span class="token parameter variable">-q</span> <span class="token string">&quot;CUSTOM_GNOME_SESSION&quot;</span> <span class="token string">&quot;<span class="token variable">$XRDP_STARTWM</span>&quot;</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">cp</span> <span class="token string">&quot;<span class="token variable">$XRDP_STARTWM</span>&quot;</span> <span class="token string">&quot;<span class="token variable">${XRDP_STARTWM}</span>.bak.<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>&quot;</span>
  <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&#39;/test -x \/etc\/X11\/Xsession/,$d&#39;</span> <span class="token string">&quot;<span class="token variable">$XRDP_STARTWM</span>&quot;</span>
  <span class="token function">cat</span> <span class="token operator">&gt;&gt;</span><span class="token string">&quot;<span class="token variable">$XRDP_STARTWM</span>&quot;</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;EOF&#39;
# CUSTOM_GNOME_SESSION
export GNOME_SHELL_SESSION_MODE=gnome
export XDG_CURRENT_DESKTOP=GNOME
export GNOME_DESKTOP_SESSION_ID=this-is-deprecated
if [ -r /etc/default/locale ]; then
  . /etc/default/locale
  export LANG LANGUAGE LC_ALL
fi
if [ -f &quot;$HOME/.xsession&quot; ]; then
  . &quot;$HOME/.xsession&quot;
fi
exec /usr/bin/gnome-session
EOF</span>
<span class="token keyword">fi</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> <span class="token string">&quot;<span class="token variable">$HOME_DIR</span>/.xsession&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;gnome-session&quot;</span> <span class="token operator">&gt;</span><span class="token string">&quot;<span class="token variable">$HOME_DIR</span>/.xsession&quot;</span>
  <span class="token function">chown</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$HOME_DIR</span>/.xsession&quot;</span> <span class="token operator">||</span> <span class="token boolean">true</span>
<span class="token keyword">fi</span>

systemctl <span class="token builtin class-name">enable</span> xrdp
systemctl restart xrdp

log INFO <span class="token string">&quot;[5/9] 安装 TigerVNC&quot;</span>
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> tigervnc-standalone-server tigervnc-common
<span class="token assign-left variable">VNC_DIR</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$HOME_DIR</span>/.vnc&quot;</span>
<span class="token function">install</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-m</span> <span class="token number">700</span> <span class="token parameter variable">-o</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token parameter variable">-g</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$VNC_DIR</span>&quot;</span>

<span class="token function">cat</span> <span class="token operator">&gt;</span><span class="token string">&quot;<span class="token variable">$VNC_DIR</span>/xstartup&quot;</span> <span class="token operator">&lt;&lt;</span><span class="token string">&#39;EOF&#39;
#!/bin/sh
unset SESSION_MANAGER
unset DBUS_SESSION_BUS_ADDRESS
export GNOME_SHELL_SESSION_MODE=gnome
export XDG_CURRENT_DESKTOP=GNOME
export GNOME_DESKTOP_SESSION_ID=this-is-deprecated
exec gnome-session &amp;
EOF</span>
<span class="token function">chown</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$VNC_DIR</span>/xstartup&quot;</span> <span class="token operator">||</span> <span class="token boolean">true</span>
<span class="token function">chmod</span> +x <span class="token string">&quot;<span class="token variable">$VNC_DIR</span>/xstartup&quot;</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">&quot;<span class="token variable">$VNC_PASS</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token builtin class-name">printf</span> <span class="token string">&quot;输入 VNC 密码(6~8位, 回车跳过): &quot;</span>
  <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">-s</span> VNC_IN<span class="token punctuation">;</span> <span class="token builtin class-name">echo</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$VNC_IN</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token assign-left variable">VNC_PASS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$VNC_IN</span>&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-n</span> <span class="token string">&quot;<span class="token variable">$VNC_PASS</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">su</span> - <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token parameter variable">-c</span> <span class="token string">&quot;mkdir -p ~/.vnc &amp;&amp; echo &#39;<span class="token variable">$VNC_PASS</span>&#39; | vncpasswd -f &gt; ~/.vnc/passwd&quot;</span>
  <span class="token function">chown</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token string">&quot;<span class="token variable">$HOME_DIR</span>/.vnc/passwd&quot;</span> <span class="token operator">||</span> <span class="token boolean">true</span>
  <span class="token function">chmod</span> <span class="token number">600</span> <span class="token string">&quot;<span class="token variable">$HOME_DIR</span>/.vnc/passwd&quot;</span>
<span class="token keyword">fi</span>

log INFO <span class="token string">&quot;[6/9] 创建 VNC systemd 服务&quot;</span>
<span class="token function">cat</span> <span class="token operator">&gt;</span>/etc/systemd/system/vnc@.service <span class="token operator">&lt;&lt;</span><span class="token string">EOF
[Unit]
Description=TigerVNC server for %i (:1)
After=network.target

[Service]
Type=forking
User=%i
PAMName=login
PIDFile=/home/%i/.vnc/%H:%i.pid
ExecStartPre=/bin/sh -c &#39;install -d -m 700 /home/%i/.vnc&#39;
ExecStart=/usr/bin/vncserver -geometry <span class="token variable">${VNC_GEOMETRY}</span> -depth <span class="token variable">${VNC_DEPTH}</span> -localhost no :1
ExecStop=/usr/bin/vncserver -kill :1

[Install]
WantedBy=multi-user.target
EOF</span>
systemctl daemon-reload
systemctl <span class="token builtin class-name">enable</span> vnc@<span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">&quot;<span class="token variable">$HOME_DIR</span>/.vnc/passwd&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  systemctl start vnc@<span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">||</span> log WARN <span class="token string">&quot;VNC 启动失败，查 ~/.vnc/*.log&quot;</span>
<span class="token keyword">else</span>
  log WARN <span class="token string">&quot;未设置 VNC 密码，稍后: sudo -u <span class="token variable">$TARGET_USER</span> vncpasswd &amp;&amp; systemctl start vnc@<span class="token variable">$TARGET_USER</span>&quot;</span>
<span class="token keyword">fi</span>

log INFO <span class="token string">&quot;[7/9] 性能优化&quot;</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$AUTO_DISABLE_ANIMATION</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;1&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;root&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">su</span> - <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token parameter variable">-c</span> <span class="token string">&quot;gsettings set org.gnome.desktop.interface enable-animations false&quot;</span> <span class="token operator">||</span> <span class="token boolean">true</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$AUTO_DISABLE_ANIMATION</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;1&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;root&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  log WARN <span class="token string">&quot;跳过 root 动画关闭 (缺少普通 DBus 桌面会话)&quot;</span>
<span class="token keyword">fi</span>

log INFO <span class="token string">&quot;[8/9] 防火墙&quot;</span>
<span class="token keyword">if</span> <span class="token builtin class-name">command</span> <span class="token parameter variable">-v</span> ufw <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  ufw allow <span class="token number">3389</span>/tcp <span class="token operator">||</span> <span class="token boolean">true</span>
  ufw allow <span class="token number">5901</span>/tcp <span class="token operator">||</span> <span class="token boolean">true</span>
<span class="token keyword">fi</span>

log INFO <span class="token string">&quot;[9/9] dpkg 自检&quot;</span>
dpkg <span class="token parameter variable">--configure</span> <span class="token parameter variable">-a</span> <span class="token operator">||</span> <span class="token boolean">true</span>
<span class="token function">apt-get</span> <span class="token parameter variable">-f</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token operator">||</span> <span class="token boolean">true</span>

<span class="token function-name function">health_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin class-name">echo</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt; 健康检查&quot;</span>
  <span class="token builtin class-name">local</span> <span class="token assign-left variable">fail</span><span class="token operator">=</span><span class="token number">0</span>
  <span class="token function-name function">CHK</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token builtin class-name">eval</span> <span class="token string">&quot;<span class="token variable">$2</span>&quot;</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;[OK] <span class="token variable">$1</span>&quot;</span><span class="token punctuation">;</span> <span class="token keyword">else</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;[FAIL] <span class="token variable">$1</span>&quot;</span><span class="token punctuation">;</span> <span class="token assign-left variable">fail</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>fail<span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span><span class="token punctuation">;</span> <span class="token keyword">fi</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">p</span> <span class="token keyword">in</span> gnome-shell gnome-session gdm3 xrdp tigervnc-standalone-server<span class="token punctuation">;</span> <span class="token keyword">do</span>
    CHK <span class="token string">&quot;包安装: <span class="token variable">$p</span>&quot;</span> <span class="token string">&quot;dpkg -s <span class="token variable">$p</span> &gt;/dev/null 2&gt;&amp;1&quot;</span>
  <span class="token keyword">done</span>
  CHK <span class="token string">&quot;gdm3 活跃&quot;</span> <span class="token string">&quot;systemctl is-active gdm3 &gt;/dev/null 2&gt;&amp;1&quot;</span>
  CHK <span class="token string">&quot;xrdp 活跃&quot;</span> <span class="token string">&quot;systemctl is-active xrdp &gt;/dev/null 2&gt;&amp;1&quot;</span>
  systemctl is-enabled vnc@<span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;[OK] VNC 服务启用&quot;</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;[WARN] VNC 服务未启用&quot;</span>
  systemctl is-active vnc@<span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;[OK] VNC 运行中&quot;</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;[WARN] VNC 未运行&quot;</span>
  CHK <span class="token string">&quot;RDP 3389 监听&quot;</span> <span class="token string">&quot;ss -tln | awk &#39;{print \<span class="token variable">$4</span>}&#39; | grep -E &#39;(:|<span class="token entity" title="\\">\\</span>.)3389\$&#39; &gt;/dev/null&quot;</span>
  CHK <span class="token string">&quot;VNC 5901 监听&quot;</span> <span class="token string">&quot;ss -tln | awk &#39;{print \<span class="token variable">$4</span>}&#39; | grep -E &#39;(:|<span class="token entity" title="\\">\\</span>.)5901\$&#39; &gt;/dev/null&quot;</span>
  CHK <span class="token string">&quot;Wayland 禁用&quot;</span> <span class="token string">&quot;grep -q &#39;^WaylandEnable=false&#39; /etc/gdm3/custom.conf&quot;</span>
  <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$fail</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;健康检查：全部通过&quot;</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;健康检查：<span class="token variable">$fail</span> 项失败&quot;</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;&gt;&gt;&gt; 结束&quot;</span>
<span class="token punctuation">}</span>

<span class="token builtin class-name">echo</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;================ 安装完成 =================&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;模式: <span class="token variable">$DESKTOP_MODE</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;用户: <span class="token variable">$TARGET_USER</span>&quot;</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$TARGET_USER</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;root&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;警告: 当前使用 root 图形会话，建议尽快创建普通用户。&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;RDP: 3389 (选择 Xorg 会话)&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;VNC: 5901 (:1 VNC 密码 &quot;</span><span class="token variable">$VNC_PASS</span><span class="token string">&quot;)&quot;</span>
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">&quot;<span class="token variable">$VNC_PASS</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;未设 VNC 密码: sudo -u <span class="token variable">$TARGET_USER</span> vncpasswd &amp;&amp; systemctl start vnc@<span class="token variable">$TARGET_USER</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;==========================================&quot;</span>

<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$RUN_VERIFY</span> <span class="token parameter variable">-eq</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> health_check
</code></pre></div><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment">### 如果出现这个错误就运行两次安装脚本</span>
Errors were encountered <span class="token keyword">while</span> processing: /tmp/apt-dpkg-install-OElkaL/0027-firefox_1%3a1snap1-0ubuntu2_amd64.deb needrestart is being skipped since dpkg has failed E: Sub-process /usr/bin/dpkg returned an error code <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="目录" tabindex="-1"><a class="header-anchor" href="#目录" aria-hidden="true">#</a> 目录</h2><ol><li>为什么需要远程桌面 &amp; 方案对比</li><li>基础准备（更新、用户、主机名、时区、镜像源）</li><li>选择桌面环境（GNOME / XFCE / MATE / LXQt）</li><li>方案一：XRDP（RDP 协议，Windows 客户端友好）</li><li>方案二：VNC（TigerVNC 实战）</li><li>方案三：X2Go（高延迟/低带宽更流畅）</li><li>其他可选方案（NoMachine / Chrome Remote Desktop / RustDesk）</li><li>安全加固（防火墙、端口、加密、Fail2Ban、最小权限）</li><li>性能优化建议</li><li>常见故障排查</li><li>常见问答（FAQ）</li><li>快速命令清单（Cheat Sheet）</li></ol><hr><h2 id="_1-为什么需要远程桌面-方案对比" tabindex="-1"><a class="header-anchor" href="#_1-为什么需要远程桌面-方案对比" aria-hidden="true">#</a> 1. 为什么需要远程桌面 &amp; 方案对比</h2><table><thead><tr><th>需求</th><th>推荐方案</th><th>优点</th><th>注意点</th></tr></thead><tbody><tr><td>Windows 自带 mstsc 直接连</td><td>XRDP</td><td>无需额外客户端</td><td>默认 3389 需加固</td></tr><tr><td>高清 GUI + 多用户 + 稳定</td><td>XRDP / X2Go</td><td>会话隔离</td><td>GNOME+XRDP 偶发黑屏</td></tr><tr><td>低带宽 / 高延迟</td><td>X2Go</td><td>NX 压缩好</td><td>客户端需安装</td></tr><tr><td>临时调试 / 嵌入其他工具</td><td>VNC over SSH</td><td>简单通用</td><td>原生加密弱</td></tr><tr><td>穿透 / 自带中继</td><td>RustDesk / Chrome</td><td>简化 NAT</td><td>依赖第三方服务</td></tr><tr><td>多媒体/3D</td><td>NoMachine</td><td>图形加速更好</td><td>闭源免费版限制</td></tr></tbody></table><hr><h2 id="_2-基础准备" tabindex="-1"><a class="header-anchor" href="#_2-基础准备" aria-hidden="true">#</a> 2. 基础准备</h2><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># 更新系统</span>
<span class="token function">sudo</span> <span class="token function">apt</span> update
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token parameter variable">-y</span> upgrade

<span class="token comment"># 安装常用工具</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> <span class="token function">curl</span> <span class="token function">wget</span> <span class="token function">vim</span> <span class="token function">htop</span> net-tools <span class="token function">unzip</span> <span class="token function">tar</span> <span class="token function">git</span>

<span class="token comment"># 设置时区（示例：Asia/Shanghai）</span>
<span class="token function">sudo</span> timedatectl set-timezone Asia/Shanghai

<span class="token comment"># 确认当前用户（避免直接用 root）</span>
<span class="token function">whoami</span>
</code></pre></div><p>如果是云服务器，建议先快照 / 备份，以便回滚。</p><hr><h2 id="_3-选择桌面环境" tabindex="-1"><a class="header-anchor" href="#_3-选择桌面环境" aria-hidden="true">#</a> 3. 选择桌面环境</h2><table><thead><tr><th>桌面</th><th>包名</th><th>内存占用（大致空闲）</th><th>适合</th></tr></thead><tbody><tr><td>GNOME (默认)</td><td>ubuntu-desktop / ubuntu-desktop-minimal</td><td>900MB~1.3GB</td><td>完整体验</td></tr><tr><td>XFCE</td><td>xubuntu-core / xubuntu-desktop</td><td>350~600MB</td><td>轻量通用</td></tr><tr><td>MATE</td><td>ubuntu-mate-core</td><td>500~800MB</td><td>传统布局</td></tr><tr><td>LXQt</td><td>lxqt-core</td><td>300~450MB</td><td>极轻量</td></tr></tbody></table><p>示例安装 XFCE（推荐在资源有限的 VPS）：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> xfce4 xfce4-goodies
</code></pre></div><p>GNOME 精简版：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> ubuntu-desktop-minimal
</code></pre></div><hr><h2 id="_4-方案一-xrdp" tabindex="-1"><a class="header-anchor" href="#_4-方案一-xrdp" aria-hidden="true">#</a> 4. 方案一：XRDP</h2><h3 id="_4-1-安装-xrdp" tabindex="-1"><a class="header-anchor" href="#_4-1-安装-xrdp" aria-hidden="true">#</a> 4.1 安装 XRDP</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> xrdp
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> xrdp
</code></pre></div><h3 id="_4-2-使用轻量桌面-可选" tabindex="-1"><a class="header-anchor" href="#_4-2-使用轻量桌面-可选" aria-hidden="true">#</a> 4.2 使用轻量桌面（可选）</h3><p>若你装了 XFCE，并让 XRDP 默认加载 XFCE：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;xfce4-session&quot;</span> <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> /etc/skel/.Xsession
<span class="token builtin class-name">echo</span> <span class="token string">&quot;xfce4-session&quot;</span> <span class="token operator">&gt;</span> ~/.Xsession
</code></pre></div><p>或针对单用户：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;startxfce4&quot;</span> <span class="token operator">&gt;</span> ~/.xsession
<span class="token function">chmod</span> +x ~/.xsession
</code></pre></div><h3 id="_4-3-gnome-与-xrdp" tabindex="-1"><a class="header-anchor" href="#_4-3-gnome-与-xrdp" aria-hidden="true">#</a> 4.3 GNOME 与 XRDP</h3><p>Ubuntu 22.04 默认启用 Wayland（登录物理机才常见）；XRDP 依赖 Xorg。如果远程黑屏，可在 <code>/etc/gdm3/custom.conf</code> 取消注释：</p><div class="language-text ext-text"><pre class="language-text"><code>#WaylandEnable=false
</code></pre></div><p>改成：</p><div class="language-text ext-text"><pre class="language-text"><code>WaylandEnable=false
</code></pre></div><p>然后：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl restart gdm3
<span class="token function">sudo</span> systemctl restart xrdp
</code></pre></div><h3 id="_4-4-ssl-证书与权限" tabindex="-1"><a class="header-anchor" href="#_4-4-ssl-证书与权限" aria-hidden="true">#</a> 4.4 SSL 证书与权限</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> adduser xrdp ssl-cert
<span class="token function">sudo</span> systemctl restart xrdp
</code></pre></div><h3 id="_4-5-防火墙" tabindex="-1"><a class="header-anchor" href="#_4-5-防火墙" aria-hidden="true">#</a> 4.5 防火墙</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> ufw allow from <span class="token operator">&lt;</span>你的办公出口IP<span class="token operator">&gt;</span>/32 to any port <span class="token number">3389</span>
<span class="token comment"># 若没有固定 IP（不推荐），临时：</span>
<span class="token comment"># sudo ufw allow 3389/tcp</span>
<span class="token function">sudo</span> ufw status
</code></pre></div><h3 id="_4-6-连接" tabindex="-1"><a class="header-anchor" href="#_4-6-连接" aria-hidden="true">#</a> 4.6 连接</h3><p>在 Windows：Win+R → mstsc → 输入服务器 IP → 用户名 + 密码。<br> 如果黑屏：看日志 <code>/var/log/xrdp.log</code> 与 <code>/var/log/xrdp-sesman.log</code>。</p><hr><h2 id="_5-方案二-vnc-tigervnc" tabindex="-1"><a class="header-anchor" href="#_5-方案二-vnc-tigervnc" aria-hidden="true">#</a> 5. 方案二：VNC（TigerVNC）</h2><h3 id="_5-1-安装" tabindex="-1"><a class="header-anchor" href="#_5-1-安装" aria-hidden="true">#</a> 5.1 安装</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> tigervnc-standalone-server tigervnc-common
</code></pre></div><h3 id="_5-2-创建-vnc-密码" tabindex="-1"><a class="header-anchor" href="#_5-2-创建-vnc-密码" aria-hidden="true">#</a> 5.2 创建 VNC 密码</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>vncpasswd
</code></pre></div><h3 id="_5-3-首次运行生成配置" tabindex="-1"><a class="header-anchor" href="#_5-3-首次运行生成配置" aria-hidden="true">#</a> 5.3 首次运行生成配置</h3><div class="language-bash ext-sh"><pre class="language-bash"><code>vncserver :1
vncserver <span class="token parameter variable">-kill</span> :1
</code></pre></div><h3 id="_5-4-配置会话-xfce-示例" tabindex="-1"><a class="header-anchor" href="#_5-4-配置会话-xfce-示例" aria-hidden="true">#</a> 5.4 配置会话（XFCE 示例）</h3><p><code>~/.vnc/xstartup</code>：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token builtin class-name">unset</span> <span class="token environment constant">SESSION_MANAGER</span>
<span class="token builtin class-name">unset</span> <span class="token environment constant">DBUS_SESSION_BUS_ADDRESS</span>
startxfce4 <span class="token operator">&amp;</span>
</code></pre></div><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">chmod</span> +x ~/.vnc/xstartup
</code></pre></div><h3 id="_5-5-systemd-管理-可选" tabindex="-1"><a class="header-anchor" href="#_5-5-systemd-管理-可选" aria-hidden="true">#</a> 5.5 Systemd 管理（可选）</h3><div class="language-text ext-text"><pre class="language-text"><code>sudo tee /etc/systemd/system/vnc@.service &gt;/dev/null &lt;&lt;&#39;EOF&#39;
[Unit]
Description=VNC per-user instance
After=network.target

[Service]
Type=forking
User=%i
PAMName=login
PIDFile=/home/%i/.vnc/%H:1.pid
ExecStartPre=/usr/bin/vncserver -kill :1 &gt; /dev/null 2&gt;&amp;1 || true
ExecStart=/usr/bin/vncserver :1 -localhost yes -geometry 1920x1080 -depth 24
ExecStop=/usr/bin/vncserver -kill :1

[Install]
WantedBy=multi-user.target
EOF
</code></pre></div><p>启用：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> vnc@<span class="token variable"><span class="token variable">$(</span><span class="token function">whoami</span><span class="token variable">)</span></span>.service
</code></pre></div><p>注意：<code>-localhost yes</code> 只监听 127.0.0.1，需配合 SSH 隧道：</p><p>本地客户端：</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">ssh</span> <span class="token parameter variable">-L</span> <span class="token number">5901</span>:localhost:5901 user@server_ip
</code></pre></div><p>然后用 VNC Viewer 连接：<code>localhost:5901</code></p><h3 id="_5-6-加密" tabindex="-1"><a class="header-anchor" href="#_5-6-加密" aria-hidden="true">#</a> 5.6 加密</h3><p>原生 VNC 加密弱，推荐永远走 SSH 隧道或 stunnel。</p><hr><h2 id="_6-方案三-x2go" tabindex="-1"><a class="header-anchor" href="#_6-方案三-x2go" aria-hidden="true">#</a> 6. 方案三：X2Go</h2><p>优点：高压缩、会话可断点续连、比 VNC 流畅。缺点：客户端需安装。</p><h3 id="_6-1-安装" tabindex="-1"><a class="header-anchor" href="#_6-1-安装" aria-hidden="true">#</a> 6.1 安装</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> x2goserver x2goserver-xsession
</code></pre></div><p>桌面可选 XFCE/ MATE。安装完后直接用 X2Go Client（Windows/macOS/Linux）添加会话：</p><ul><li>Host：服务器 IP</li><li>SSH Port：22</li><li>Session type：XFCE / MATE / GNOME (需 Xorg)</li><li>Compression：根据带宽调整（默认即可）</li></ul><hr><h2 id="_7-其他方案-一行点评" tabindex="-1"><a class="header-anchor" href="#_7-其他方案-一行点评" aria-hidden="true">#</a> 7. 其他方案（一行点评）</h2><table><thead><tr><th>方案</th><th>说明</th></tr></thead><tbody><tr><td>NoMachine (nomachine.com)</td><td>图形与多媒体表现好，私有协议</td></tr><tr><td>Chrome Remote Desktop</td><td>穿透简单，需 Google 账号</td></tr><tr><td>RustDesk</td><td>开源 + 自建中继选项，很适合内网穿透</td></tr><tr><td>Apache Guacamole</td><td>Web 端统一接入 RDP/VNC/SSH</td></tr><tr><td>RDP over SSH</td><td>不暴露 3389，安全性提升</td></tr></tbody></table><hr><h2 id="_8-安全加固" tabindex="-1"><a class="header-anchor" href="#_8-安全加固" aria-hidden="true">#</a> 8. 安全加固</h2><ol><li>不裸露 3389 / 5901：用 SSH 隧道 / WireGuard / VPN。</li><li>修改默认端口（XRDP）：<code>/etc/xrdp/xrdp.ini</code> 中 <code>port=3389</code> → 改为自定义。</li><li>限制来源 IP：<code>ufw allow from 1.2.3.4 to any port 3389</code>。</li><li>Fail2Ban 规则（XRDP）：<div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> fail2ban
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/fail2ban/jail.d/xrdp.local <span class="token operator">&gt;</span>/dev/null <span class="token operator">&lt;&lt;</span><span class="token string">&#39;EOF&#39;
[xrdp]
enabled = true
port = 3389
filter = xrdp
logpath = /var/log/auth.log
maxretry = 5
bantime = 3600
EOF</span>
<span class="token function">sudo</span> systemctl restart fail2ban
</code></pre></div>（需自建 filter：<code>/etc/fail2ban/filter.d/xrdp.conf</code>）</li><li>使用强密码 / SSH 公钥登录。</li><li>定期升级安全补丁：<code>sudo apt update &amp;&amp; sudo apt -y upgrade</code></li><li>监控登录行为：<code>journalctl -u xrdp --since &quot;1 hour ago&quot;</code> / <code>last</code>。</li><li>多用户隔离：不要共享同一账号；用最小 sudo 权限。</li></ol><hr><h2 id="_9-性能优化" tabindex="-1"><a class="header-anchor" href="#_9-性能优化" aria-hidden="true">#</a> 9. 性能优化</h2><table><thead><tr><th>优化点</th><th>操作</th></tr></thead><tbody><tr><td>减少特效</td><td>在桌面设置中关闭动画/透明</td></tr><tr><td>使用轻量桌面</td><td>改用 XFCE / LXQt</td></tr><tr><td>降分辨率、色深</td><td>XRDP 客户端选择 16-bit 色深；VNC 降到 1280x720</td></tr><tr><td>压缩</td><td>X2Go 默认已做；VNC 加 <code>-quality 50 -depth 16</code></td></tr><tr><td>减少服务</td><td><code>systemctl disable</code> 不必要守护进程</td></tr><tr><td>IO 优化</td><td>使用 SSD，启用 zram（低内存 VPS）</td></tr><tr><td>监控瓶颈</td><td><code>htop</code>, <code>glances</code>, <code>iotop</code>, <code>nload</code></td></tr></tbody></table><hr><h2 id="_10-常见故障排查" tabindex="-1"><a class="header-anchor" href="#_10-常见故障排查" aria-hidden="true">#</a> 10. 常见故障排查</h2><p>| 症状 | 可能原因 | 解决 | | ------------------- | -------------------------- | --------------------------------------------------------- | ----------------------------- | | XRDP 黑屏 | Wayland / .Xauthority 权限 | 关 Wayland；<code>sudo chown user:user ~/.Xauthority</code> | | 登录后立即断开 | 桌面未安装 / 进程崩溃 | 确认 <code>startxfce4</code> 可本地启动 | | VNC 连接拒绝 | 未启动 / 监听仅本地 | <code>ss -tnlp | grep 5901</code>；检查 systemd 服务 | | 中文乱码 | 缺字体 | <code>sudo apt install -y fonts-wqy-zenhei fonts-wqy-microhei</code> | | PulseAudio 远程无声 | XRDP 限制 / 模块缺 | 若需声音考虑 X2Go 或 NoMachine | | 端口被扫爆 | 直接暴露 | 改端口 + 防火墙 + Fail2Ban + 隧道 | | X2Go 只显示灰屏 | 桌面类型不匹配 | 在客户端会话选 XFCE / MATE |</p><p>查看日志命令参考：</p><div class="language-bash ext-sh"><pre class="language-bash"><code>journalctl <span class="token parameter variable">-u</span> xrdp <span class="token parameter variable">-f</span>
journalctl <span class="token parameter variable">-u</span> xrdp-sesman <span class="token parameter variable">-f</span>
<span class="token function">tail</span> <span class="token parameter variable">-f</span> /var/log/xrdp.log /var/log/xrdp-sesman.log
<span class="token function">tail</span> <span class="token parameter variable">-f</span> ~/.vnc/*.log
</code></pre></div><hr><h2 id="_11-faq" tabindex="-1"><a class="header-anchor" href="#_11-faq" aria-hidden="true">#</a> 11. FAQ</h2><p><strong>Q: 必须装整个 ubuntu-desktop 吗？</strong><br> A: 不必须。资源紧张选 <code>xfce4</code> 或 <code>xubuntu-core</code> 即可。</p><p><strong>Q: 能否和 SSH 共用同一用户？</strong><br> A: 可以。但建议不同人不同账号，日志更清晰。</p><p><strong>Q: RDP 要不要换端口？</strong><br> A: 不是必须，但能减少低质量扫描噪音；真正安全依赖访问控制和加密隧道。</p><p><strong>Q: 需要 GPU 加速 / AI 可视化？</strong><br> A: 考虑 NoMachine、Xpra 或在本地 Jupyter / VS Code Remote。</p><p><strong>Q: 能否只传应用窗口？</strong><br> A: X2Go / xpra 支持更细粒度；本文主要讨论整桌面会话。</p><hr><h2 id="_12-快速命令清单-cheat-sheet" tabindex="-1"><a class="header-anchor" href="#_12-快速命令清单-cheat-sheet" aria-hidden="true">#</a> 12. 快速命令清单（Cheat Sheet）</h2><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># 更新</span>
<span class="token function">sudo</span> <span class="token function">apt</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token parameter variable">-y</span> upgrade

<span class="token comment"># 安装轻量桌面 + XRDP</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> xfce4 xfce4-goodies xrdp
<span class="token builtin class-name">echo</span> <span class="token string">&quot;startxfce4&quot;</span> <span class="token operator">&gt;</span> ~/.xsession
<span class="token function">sudo</span> adduser <span class="token environment constant">$USER</span> ssl-cert
<span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> <span class="token parameter variable">--now</span> xrdp

<span class="token comment"># 防火墙限制来源</span>
<span class="token function">sudo</span> ufw allow from <span class="token number">1.2</span>.3.4 to any port <span class="token number">3389</span>

<span class="token comment"># VNC (TigerVNC) + SSH 隧道</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> tigervnc-standalone-server
vncpasswd
vncserver :1
vncserver <span class="token parameter variable">-kill</span> :1
<span class="token comment"># 编辑 ~/.vnc/xstartup -&gt; startxfce4</span>
vncserver :1 <span class="token parameter variable">-localhost</span> <span class="token function">yes</span>
<span class="token function">ssh</span> <span class="token parameter variable">-L</span> <span class="token number">5901</span>:localhost:5901 user@server_ip  <span class="token comment"># 本地连接 localhost:5901</span>

<span class="token comment"># X2Go</span>
<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> x2goserver x2goserver-xsession xfce4

<span class="token comment"># 卸载 XRDP（可选）</span>
<span class="token function">sudo</span> systemctl disable <span class="token parameter variable">--now</span> xrdp
<span class="token function">sudo</span> <span class="token function">apt</span> purge <span class="token parameter variable">-y</span> xrdp
</code></pre></div><hr><h2 id="结语" tabindex="-1"><a class="header-anchor" href="#结语" aria-hidden="true">#</a> 结语</h2><p>选择合适的远程桌面方案，关键看你的客户端环境、带宽、延迟与安全要求：</p><ul><li>Windows 原生：XRDP</li><li>低带宽 + 稳定性：X2Go</li><li>需要临时 GUI + 通用性：VNC over SSH</li><li>多媒体或穿透：NoMachine / RustDesk</li></ul><p>部署后请务必落实：防火墙限制、强密码/公钥认证、日志监控及定期升级，避免远程桌面成为攻击入口。</p><p>如需：</p><ul><li>仅最精简脚本</li><li>自动化一键安装脚本</li><li>为你当前服务器配置定制方案</li></ul><p>继续留言即可。</p><p>祝你部署顺利！</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><div class="pager"><a href="/post/2025/06/20/prometheus+grafana%E9%83%A8%E7%BD%B2/" class="prev">Previous <br><span>Prometheus+Grafana Docker部署初体验</span></a><!----></div><!--]--><!----></main><ul class="catalog" style="top:0px;"><li class="level-3 toc-link-直接上完整的一键安装-shell">直接上完整的一键安装 shell</li><li class="level-2 toc-link-目录">目录</li><li class="level-2 toc-link-_1-为什么需要远程桌面-方案对比">1. 为什么需要远程桌面 &amp; 方案对比</li><li class="level-2 toc-link-_2-基础准备">2. 基础准备</li><li class="level-2 toc-link-_3-选择桌面环境">3. 选择桌面环境</li><li class="level-2 toc-link-_4-方案一-xrdp">4. 方案一：XRDP</li><li class="level-3 toc-link-_4-1-安装-xrdp">4.1 安装 XRDP</li><li class="level-3 toc-link-_4-2-使用轻量桌面-可选">4.2 使用轻量桌面（可选）</li><li class="level-3 toc-link-_4-3-gnome-与-xrdp">4.3 GNOME 与 XRDP</li><li class="level-3 toc-link-_4-4-ssl-证书与权限">4.4 SSL 证书与权限</li><li class="level-3 toc-link-_4-5-防火墙">4.5 防火墙</li><li class="level-3 toc-link-_4-6-连接">4.6 连接</li><li class="level-2 toc-link-_5-方案二-vnc-tigervnc">5. 方案二：VNC（TigerVNC）</li><li class="level-3 toc-link-_5-1-安装">5.1 安装</li><li class="level-3 toc-link-_5-2-创建-vnc-密码">5.2 创建 VNC 密码</li><li class="level-3 toc-link-_5-3-首次运行生成配置">5.3 首次运行生成配置</li><li class="level-3 toc-link-_5-4-配置会话-xfce-示例">5.4 配置会话（XFCE 示例）</li><li class="level-3 toc-link-_5-5-systemd-管理-可选">5.5 Systemd 管理（可选）</li><li class="level-3 toc-link-_5-6-加密">5.6 加密</li><li class="level-2 toc-link-_6-方案三-x2go">6. 方案三：X2Go</li><li class="level-3 toc-link-_6-1-安装">6.1 安装</li><li class="level-2 toc-link-_7-其他方案-一行点评">7. 其他方案（一行点评）</li><li class="level-2 toc-link-_8-安全加固">8. 安全加固</li><li class="level-2 toc-link-_9-性能优化">9. 性能优化</li><li class="level-2 toc-link-_10-常见故障排查">10. 常见故障排查</li><li class="level-2 toc-link-_11-faq">11. FAQ</li><li class="level-2 toc-link-_12-快速命令清单-cheat-sheet">12. 快速命令清单（Cheat Sheet）</li><li class="level-2 toc-link-结语">结语</li></ul></div><!--]--></div><div class="search-page" role="search"><span class="search-close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" width="28" height="28" fill="currentColor"><path d="M224 416c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L224 338.8l169.4-169.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-192 192C240.4 412.9 232.2 416 224 416z"></path></svg></span><div class="gungnir-search-box"><input placeholder="$ grep ..." autocomplete="off" spellcheck="false" value><!----></div></div><div class="menu-btn-container"><div class="menu-btn-wrapper"><div class="menu-btn"><div style="" class="menu-btn-icon"><span></span><span></span><span></span></div><div style="display:none;" class="menu-text">0</div><svg class="menu-progress"><circle class="menu-border" cx="50%" cy="50%" r="48%" style="stroke-dasharray:0% 314.15926%;"></circle></svg></div><div class="menu-btn-child-wrapper"><div title="toggle color mode" class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"/></svg><svg class="ov-icon" style="font-size:1.2em;display:none;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M283.211 512c78.962 0 151.079-35.925 198.857-94.792 7.068-8.708-.639-21.43-11.562-19.35-124.203 23.654-238.262-71.576-238.262-196.954 0-72.222 38.662-138.635 101.498-174.394 9.686-5.512 7.25-20.197-3.756-22.23A258.156 258.156 0 00283.211 0c-141.309 0-256 114.511-256 256 0 141.309 114.511 256 256 256z"/></svg><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M224 96l16-32 32-16-32-16-16-32-16 32-32 16 32 16 16 32zM80 160l26.66-53.33L160 80l-53.34-26.67L80 0 53.34 53.33 0 80l53.34 26.67L80 160zm352 128l-26.66 53.33L352 368l53.34 26.67L432 448l26.66-53.33L512 368l-53.34-26.67L432 288zm70.62-193.77L417.77 9.38C411.53 3.12 403.34 0 395.15 0c-8.19 0-16.38 3.12-22.63 9.38L9.38 372.52c-12.5 12.5-12.5 32.76 0 45.25l84.85 84.85c6.25 6.25 14.44 9.37 22.62 9.37 8.19 0 16.38-3.12 22.63-9.37l363.14-363.15c12.5-12.48 12.5-32.75 0-45.24zM359.45 203.46l-50.91-50.91 86.6-86.6 50.91 50.91-86.6 86.6z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></div><div class="menu-btn-child"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-75.52 -43.52 599.04 599.04" fill="currentColor"><path d="M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z"/></svg></div><div class="menu-btn-child menu-toc-btn"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-43.52 -43.52 599.04 599.04" fill="currentColor"><path d="M48 48a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm0 160a48 48 0 1048 48 48 48 0 00-48-48zm448 16H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16zm0-320H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16V80a16 16 0 00-16-16zm0 160H176a16 16 0 00-16 16v32a16 16 0 0016 16h320a16 16 0 0016-16v-32a16 16 0 00-16-16z"/></svg></div><div class="toggle-sidebar-button menu-btn-child menu-btn-sidebar" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><svg class="ov-icon" style="font-size:1.2em;" aria-hidden="true" width="19.2" height="19.2" viewBox="-1.6 -1.6 19.2 19.2" fill="currentColor"><path d="M14 2a1 1 0 011 1v10a1 1 0 01-1 1H2a1 1 0 01-1-1V3a1 1 0 011-1h12zM2 1a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V3a2 2 0 00-2-2H2z"/><path d="M3 4a1 1 0 011-1h2a1 1 0 011 1v8a1 1 0 01-1 1H4a1 1 0 01-1-1V4z"/></svg></div></div></div></div><footer class="footer"><span>
      &copy; <a href="https://github.com/Renovamen" target="_blank">Oort</a> 2009-2024
      <br>
      Powered by <a href="https://v2.vuepress.vuejs.org" target="_blank">VuePress</a> & <a href="https://github.com/Renovamen/vuepress-theme-gungnir" target="_blank">Gungnir</a>
      <br>
      <a target="_blank" href="https://beian.miit.gov.cn">沪ICP备11018329号-5 / </a>
      <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=31010402002252">沪公网安备31010402002252号  </a>
     </span></footer></div><!--]--></div>
    <script type="module" src="/assets/app.414af06b.js" defer></script>
  </body>
</html>
